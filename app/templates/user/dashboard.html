{% extends "dashboard_base.html" %}
{% block title %}داشبورد | {{ site.brand }}{% endblock %}

{% block content %}
<div class="topbar d-flex justify-content-between align-items-center">
  <h3 class="m-0">داشبورد کاربر</h3>

  <!-- Quick actions -->
  <div class="d-flex gap-2">
    <a href="#" class="btn btn-primary btn-sm">
      <i class="fas fa-calendar-plus ms-1"></i> رزرو جدید
    </a>
    <a href="{{ url_for('main.wallet') }}" class="btn btn-success btn-sm">
      <i class="fas fa-wallet ms-1"></i> شارژ کیف پول
    </a>
  </div>
</div>

<div class="container-fluid">
  <div class="row gy-4">

    <!-- Wallet -->
    <div class="col-lg-4">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <h5 class="card-title mb-0">کیف پول</h5>
            <i class="fas fa-wallet text-success fs-4"></i>
          </div>

          <div class="mt-3">
            <div class="text-muted small">موجودی فعلی</div>
            <div class="fs-3 fw-bold text-success">
              {{ current_user.wallet_balance or 0 }} تومان
            </div>
          </div>

          <a href="{{ url_for('main.wallet') }}" class="btn btn-outline-success btn-sm mt-3">
            مدیریت کیف پول
          </a>
        </div>
      </div>
    </div>

    <!-- Membership -->
    <div class="col-lg-4">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <h5 class="card-title mb-0">اشتراک فعلی</h5>
            <i class="fas fa-id-card text-primary fs-4"></i>
          </div>

          {% if current_user.membership %}
            <p class="mt-3 text-muted">
              طرح: {{ current_user.membership.name }}<br>
              اعتبار تا: {{ current_user.membership.expires_at }}
            </p>
            <a href="#" class="btn btn-primary btn-sm">تمدید اشتراک</a>
          {% else %}
            <p class="text-muted mt-3">شما اشتراک فعالی ندارید.</p>
            <a href="#" class="btn btn-outline-primary btn-sm">خرید اشتراک</a>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Reservations -->
    <div class="col-lg-4">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <h5 class="card-title mb-0">رزروهای من</h5>
            <i class="fas fa-calendar-check text-info fs-4"></i>
          </div>

          <p class="text-muted mt-3">
            {% if next_reservation %}
              رزرو بعدی:  
              {{ next_reservation.date }} ساعت {{ next_reservation.time }}
            {% else %}
              رزرو فعالی ندارید.
            {% endif %}
          </p>

          <a href="{{ url_for('main.bookings') }}" class="btn btn-outline-info btn-sm">
            مشاهده همه رزروها
          </a>
        </div>
      </div>
    </div>

    <!-- Classes -->
    <div class="col-lg-4">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <h5 class="card-title mb-0">کلاس‌های من</h5>
            <i class="fas fa-swimmer text-warning fs-4"></i>
          </div>

          <p class="text-muted mt-3">
            {% if my_classes %}
              شما در {{ my_classes|length }} کلاس فعال شرکت دارید.
            {% else %}
              هنوز در کلاسی ثبت‌نام نکرده‌اید.
            {% endif %}
          </p>

          <a href="#" class="btn btn-outline-warning btn-sm">مشاهده کلاس‌ها</a>
        </div>
      </div>
    </div>

  </div>
</div>
{% endblock %}
